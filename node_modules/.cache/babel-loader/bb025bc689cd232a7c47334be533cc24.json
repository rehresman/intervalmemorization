{"ast":null,"code":"import _objectSpread from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{connect}from\"react-redux\";import{updateFlashcardShownTime,updateStats,updateProbability}from\"./actions/index\";import{getResponseTime}from\"./statistics.js\";import{jStat}from\"jstat\";var Flashcard=/*#__PURE__*/function(_React$Component){_inherits(Flashcard,_React$Component);var _super=_createSuper(Flashcard);function Flashcard(){var _this;_classCallCheck(this,Flashcard);_this=_super.call(this);_this.state={note:null,interval:null,answer:null,showAnswer:false};_this.chooseNext=_this.chooseNext.bind(_assertThisInitialized(_this));_this.getNewProbability=_this.getNewProbability.bind(_assertThisInitialized(_this));_this.getRandomNote=_this.getRandomNote.bind(_assertThisInitialized(_this));_this.getRandomInterval=_this.getRandomInterval.bind(_assertThisInitialized(_this));_this.getAnswer=_this.getAnswer.bind(_assertThisInitialized(_this));_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));return _this;}_createClass(Flashcard,[{key:\"chooseNext\",value:function chooseNext(){var n=Math.floor(Math.random()*12);var i=Math.floor(Math.random()*11)+1;var selection=this.props.notes[n].intervals[i];if(Math.random()>selection.probability){return this.chooseNext();}else{return{note:this.props.notes[n],interval:this.props.notes[n].intervals[i]};}}},{key:\"componentDidMount\",value:function componentDidMount(){this.setState({note:this.getRandomNote(),interval:this.getRandomInterval(),answer:null});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevState.note!==this.state.note||prevState.interval!==this.state.interval){this.setState(this.getAnswer);}}},{key:\"getNewProbability\",value:function getNewProbability(prevStats,time){var responseTime=getResponseTime(prevStats,time);var responseScore=jStat.gamma.cdf(responseTime,prevStats.alpha,1/prevStats.beta);var p=this.state.note.interval.probability;//p=.7\n//rS = .6\n//output = .7 - .3 *(rS - .5)\n// output should be .7 if rS = .5\n//output should be greater than .7 if rS < .5\n//output should be less than .7 if rS > .5\n/*\n\t\t\t\tex.\n\t\t\t\t.7 - .3 * (.6 - .5) = .7 - .03 = .67.  A slight decrease in probability \n\t\t\t\tto be shown again.\n\t\t\t\t\n\t\t\t\tp=.5\n\t\t\t\trS = .5\n\t\t\t\t.5 - .5 *(.5-.5) = .5\n\n\t\t\t\tp = .4\n\t\t\t\trS = .8\n\t\t\t\t.4 - .6(.8 - .5) = .22\n\n\t\t\t\tp = .4\n\t\t\t\trS = .3\n\t\t\t\t.4 - .6(.3 - .5) = .52\n\n\t\t*/return p+(1-p)*(responseScore-0.5);}},{key:\"getRandomNote\",value:function getRandomNote(){return this.props.notes[0];}},{key:\"getRandomInterval\",value:function getRandomInterval(){return this.props.notes[0].intervals[1];}},{key:\"getAnswer\",value:function getAnswer(state){var number=(state.note.number+state.interval.size)%Object.entries(this.props.notes).length;var answer=_objectSpread({},this.props.notes[number]);return _objectSpread({},state,{answer:answer});}},{key:\"handleClick\",value:function handleClick(){var time=new Date().getTime();if(this.state.showAnswer){this.props.dispatch(updateFlashcardShownTime(time));this.setState(_objectSpread({},this.chooseNext(),{showAnswer:false}));}else{if(this.props.stats.flashcardShownTime){var probability=this.getNewProbability(this.props.stats,time);this.props.dispatch(updateStats(time));this.props.dispatch(updateProbability(this.state.note,this.state.interval,probability));}this.setState({showAnswer:true});}}},{key:\"render\",value:function render(){var noteDetails=this.state.note?this.state.note.name:null;var intervalDetails=this.state.interval?this.state.interval.name:null;var answerDetails=this.state.answer?this.state.answer.name:null;var answerClasses=\"answer hide\";var flashcardClasses=\"border\";var intervalClasses=\"interval lightgray\";if(this.state.showAnswer){answerClasses=\"answer show\";flashcardClasses=\"border bg-white text-dark\";intervalClasses=\"interval darkgray\";}if(this.props.viewControls){flashcardClasses+=\" hide\";}return/*#__PURE__*/React.createElement(\"div\",{id:\"flashcard\",className:flashcardClasses,onClick:this.handleClick},/*#__PURE__*/React.createElement(\"section\",{className:\"note\"},noteDetails),/*#__PURE__*/React.createElement(\"section\",{className:intervalClasses},intervalDetails),/*#__PURE__*/React.createElement(\"section\",{className:answerClasses},answerDetails));}}]);return Flashcard;}(React.Component);function mapStateToProps(_ref){var notes=_ref.notes,viewControls=_ref.viewControls,stats=_ref.stats;return{notes:notes,viewControls:viewControls,stats:stats};}export default connect(mapStateToProps)(Flashcard);","map":{"version":3,"sources":["/Users/ryanehresman/Documents/JS/create-react-app-next/musicstudy/src/flashcard.js"],"names":["React","connect","updateFlashcardShownTime","updateStats","updateProbability","getResponseTime","jStat","Flashcard","state","note","interval","answer","showAnswer","chooseNext","bind","getNewProbability","getRandomNote","getRandomInterval","getAnswer","handleClick","n","Math","floor","random","i","selection","props","notes","intervals","probability","setState","prevProps","prevState","prevStats","time","responseTime","responseScore","gamma","cdf","alpha","beta","p","number","size","Object","entries","length","Date","getTime","dispatch","stats","flashcardShownTime","noteDetails","name","intervalDetails","answerDetails","answerClasses","flashcardClasses","intervalClasses","viewControls","Component","mapStateToProps"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n\tupdateFlashcardShownTime,\n\tupdateStats,\n\tupdateProbability,\n} from \"./actions/index\";\nimport { getResponseTime } from \"./statistics.js\";\nimport { jStat } from \"jstat\";\n\nclass Flashcard extends React.Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tnote: null,\n\t\t\tinterval: null,\n\t\t\tanswer: null,\n\t\t\tshowAnswer: false,\n\t\t};\n\t\tthis.chooseNext = this.chooseNext.bind(this);\n\t\tthis.getNewProbability = this.getNewProbability.bind(this);\n\t\tthis.getRandomNote = this.getRandomNote.bind(this);\n\t\tthis.getRandomInterval = this.getRandomInterval.bind(this);\n\t\tthis.getAnswer = this.getAnswer.bind(this);\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t}\n\n\tchooseNext() {\n\t\tconst n = Math.floor(Math.random() * 12);\n\t\tconst i = Math.floor(Math.random() * 11) + 1;\n\t\tconst selection = this.props.notes[n].intervals[i];\n\t\tif (Math.random() > selection.probability) {\n\t\t\treturn this.chooseNext();\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tnote: this.props.notes[n],\n\t\t\t\tinterval: this.props.notes[n].intervals[i],\n\t\t\t};\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setState({\n\t\t\tnote: this.getRandomNote(),\n\t\t\tinterval: this.getRandomInterval(),\n\t\t\tanswer: null,\n\t\t});\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (\n\t\t\tprevState.note !== this.state.note ||\n\t\t\tprevState.interval !== this.state.interval\n\t\t) {\n\t\t\tthis.setState(this.getAnswer);\n\t\t}\n\t}\n\n\tgetNewProbability(prevStats, time) {\n\t\tconst responseTime = getResponseTime(prevStats, time);\n\t\tconst responseScore = jStat.gamma.cdf(\n\t\t\tresponseTime,\n\t\t\tprevStats.alpha,\n\t\t\t1 / prevStats.beta\n\t\t);\n\t\tconst p = this.state.note.interval.probability;\n\n\t\t//p=.7\n\t\t//rS = .6\n\t\t//output = .7 - .3 *(rS - .5)\n\t\t// output should be .7 if rS = .5\n\t\t//output should be greater than .7 if rS < .5\n\t\t//output should be less than .7 if rS > .5\n\t\t/*\n\t\t\t\tex.\n\t\t\t\t.7 - .3 * (.6 - .5) = .7 - .03 = .67.  A slight decrease in probability \n\t\t\t\tto be shown again.\n\t\t\t\t\n\t\t\t\tp=.5\n\t\t\t\trS = .5\n\t\t\t\t.5 - .5 *(.5-.5) = .5\n\n\t\t\t\tp = .4\n\t\t\t\trS = .8\n\t\t\t\t.4 - .6(.8 - .5) = .22\n\n\t\t\t\tp = .4\n\t\t\t\trS = .3\n\t\t\t\t.4 - .6(.3 - .5) = .52\n\n\t\t*/\n\n\t\treturn p + (1 - p) * (responseScore - 0.5);\n\t}\n\n\tgetRandomNote() {\n\t\treturn this.props.notes[0];\n\t}\n\n\tgetRandomInterval() {\n\t\treturn this.props.notes[0].intervals[1];\n\t}\n\n\tgetAnswer(state) {\n\t\tconst number =\n\t\t\t(state.note.number + state.interval.size) %\n\t\t\tObject.entries(this.props.notes).length;\n\t\tlet answer = { ...this.props.notes[number] };\n\t\treturn { ...state, answer };\n\t}\n\n\thandleClick() {\n\t\tconst time = new Date().getTime();\n\t\tif (this.state.showAnswer) {\n\t\t\tthis.props.dispatch(updateFlashcardShownTime(time));\n\t\t\tthis.setState({\n\t\t\t\t...this.chooseNext(),\n\t\t\t\tshowAnswer: false,\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.props.stats.flashcardShownTime) {\n\t\t\t\tconst probability = this.getNewProbability(this.props.stats, time);\n\t\t\t\tthis.props.dispatch(updateStats(time));\n\t\t\t\tthis.props.dispatch(\n\t\t\t\t\tupdateProbability(this.state.note, this.state.interval, probability)\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setState({ showAnswer: true });\n\t\t}\n\t}\n\n\trender() {\n\t\tconst noteDetails = this.state.note ? this.state.note.name : null;\n\t\tconst intervalDetails = this.state.interval\n\t\t\t? this.state.interval.name\n\t\t\t: null;\n\t\tconst answerDetails = this.state.answer ? this.state.answer.name : null;\n\t\tlet answerClasses = \"answer hide\";\n\t\tlet flashcardClasses = \"border\";\n\t\tlet intervalClasses = \"interval lightgray\";\n\t\tif (this.state.showAnswer) {\n\t\t\tanswerClasses = \"answer show\";\n\t\t\tflashcardClasses = \"border bg-white text-dark\";\n\t\t\tintervalClasses = \"interval darkgray\";\n\t\t}\n\t\tif (this.props.viewControls) {\n\t\t\tflashcardClasses += \" hide\";\n\t\t}\n\t\treturn (\n\t\t\t<div\n\t\t\t\tid=\"flashcard\"\n\t\t\t\tclassName={flashcardClasses}\n\t\t\t\tonClick={this.handleClick}\n\t\t\t>\n\t\t\t\t<section className=\"note\">{noteDetails}</section>\n\t\t\t\t<section className={intervalClasses}>{intervalDetails}</section>\n\t\t\t\t<section className={answerClasses}>{answerDetails}</section>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nfunction mapStateToProps({ notes, viewControls, stats }) {\n\treturn { notes, viewControls, stats };\n}\n\nexport default connect(mapStateToProps)(Flashcard);\n"]},"metadata":{},"sourceType":"module"}